# Репозиторий архивирован
Т.к. в разработке находится новый бот. С.м. https://github.com/alfoworks/MRVN2

# kaizen85-discord
Модульный Discord-бот на rewrite ветке discord.py

### Примеры и документация
#### Готовый модуль с командой
```python
import kaizen85modules
import discord

class Module(kaizen85modules.ModuleHandler.Module):
    name = "ExampleModule"
    desc = "Описание модуля"

    async def run(self, bot: kaizen85modules.KaizenBot): 
        class ExampleCommand(bot.module_handler.Command):
            name = "example"
            desc = "Описание команды"
            args = ""

            async def run(self, message: discord.Message, args, keys) -> bool:
                await bot.send_info_embed(message.channel, "Тест команды!")

                return True 
        bot.module_handler.add_command(ExampleCommand(), self) 
```
#### Модули
##### Атрибуты модуля
`name (str)` - имя модуля. Пробелы не допускаются. \
`desc (str)` - описание модуля.
##### Методы модуля
```python
async def run(bot):
    pass
```
"Главный" метод модуля, выполняющийся во время ивента on_ready в Discord.
Здесь проводится инициализация модуля, добавление команд, параметров, etc.
```python
async def on_unload():
    pass
```
Данный метод вызывается при отгрузке модуля. 
###### Ивенты Discord
В обычных случаях, чтобы использовать ивенты, используется аннотация @client.event. 
Однако в случае с модулями, использовать такую аннотацию нельзя, так как она создаст конфликты с другими модулями или основой бота. <br> 
Для решения этой проблемы все ивенты были продублированы как методы в каждом модуле. Для использования того или иного ивента, необходимо просто переопределить метод с именем ивента из документации discord.py. <br>
Пример:
```python
import kaizen85modules
import discord

class Module(kaizen85modules.ModuleHandler.Module):
    async def on_message(self, message: discord.Message, bot: kaizen85modules.KaizenBot):
        print("Новое сообщение от %s с текстом \"%s\"" % (message.author.display_name, message.content))
```
#### Команды
##### Атрибуты команды
`name (str)` - имя команды, очевидно должно быть в нижнем регистре и без пробелов. \
`desc (str)` - описание команды.
`args (str)` - ОПИСАНИЕ аргументов команды. На выполнение самой команды эта строка не влияет, она нужна лишь для описания. \
`keys (list)` - список ключей команды, так же необходимый для описание, и не более. Каждый ключ указывать без пробелов и символов в начале, чистый текст. \
`permissions (list)` - список прав, необходимых пользователю для выполнения команды. Сюда можно вбить любую строку в нижнем регистре отсюда: https://discordapp.com/developers/docs/topics/permissions. Если хотя бы один перм отсутствует у пользователя, то команда не будет выполнена.
##### Методы команды
```python
async def run(message, args, keys) -> bool:
    return True
```
Это единственный метод команды, который выполняется.. при её выполнении! Аргументы этого метода: \
`message` - объект `discord.Message` \
`args` - список с аргументами команды. Он представляет из себя сообщение, разделенное по пробелам с убранным первым элементом (т.е. самой командой) \
`keys` - список ключей, указанных в команде. Ключ - любой аргумент, начинающийся с **--**, в этот список они попадают уже без двойного подчёркивания. В списке `args` ключей, находящихся тут, нет. \
Данный метод должен обязательно возвращать булевое значение - `True` или `False`. \
`True` необходимо возвращать в том случае, когда команде хватило аргументов. `False` - когда аргументов недостаточно. \
Это очень полезно использовать во всяких проверках, например, `if len(args) < 1`.
##### Исключения команд
На данный момент существует только одно исключение - kaizen85modules.KaizenBot.AccessDeniedException \
Вызов данного исключения создает тот же результат, как при недостатке прав у пользователя. Это может пригодиться, например, когда какая-то часть команды требует отличных от другой части прав.
#### To be continued
Здесь еще много нужно понаписать - например, о системе параметров, фоновых задач, и прочем. Скоро всё будет, а пока - копируйте все из других модулей <3.
